<?xml version='1.0' encoding='UTF-8'?>
<library>
    <addon plugin="cel.addons.questdef" >

      <quest name="clickerObject">
	<state name="init">
	  <trigger type="message">
	    <fireon entity="$this" mask="ares.activate" />
	    <reward type="debugprint" message="=?counter" />
	    <reward type="changeproperty" entity="$this" property="counter" diff="1" />
	    <reward type="newstate" state="init" />
	  </trigger>
	</state>
      </quest>

      <quest name="glowQuest">
        <state name="init">
	  <oninit>
	    <reward sequence='animglow' type='sequence' entity='$this' entity_tag='glow' />
	  </oninit>
	  <trigger type="sequencefinish">
	    <fireon entity="$this" sequence="animglow" entity_tag='glow'/>
	    <reward type="newstate" state="init2" />
	  </trigger>
        </state>
	<state name="init2">
	  <oninit>
	    <reward type="newstate" state="init" />
	  </oninit>
	</state>
        <sequence name="animglow">
          <op entity="$this" type="ambientmesh" duration="$dur" >
	    <abscolor red="0" green="0" blue="1" />
          </op>
	  <delay time="$dur" />
          <op entity="$this" type="ambientmesh" duration="$dur" >
	    <abscolor red="1" green="0" blue="0" />
          </op>
	  <delay time="$dur" />
        </sequence>
      </quest>

    </addon>

  <addon plugin="cel.addons.celentitytpl" entityname="Crate"> <propclass name="pcobject.mesh" /> </addon>
  <addon plugin="cel.addons.celentitytpl" entityname="Box">
      <propclass name="pcobject.mesh" />
      <propclass name="pctools.properties">
	<property name="counter" long="1" />
      </propclass>
      <propclass name="pclogic.quest" tag="glow">
        <action name="NewQuest" >
          <par name="name" string="glowQuest" />
          <par name="dur" string="100" />
        </action>
        <property name="state" string="init" />
      </propclass>
      <propclass name="pclogic.quest" tag="clicker">
        <action name="NewQuest" >
          <par name="name" string="clickerObject" />
        </action>
        <property name="state" string="init" />
      </propclass>
  </addon>
  <addon plugin="cel.addons.celentitytpl" entityname="SmallBox"> <propclass name="pcobject.mesh" /> </addon>
  <addon plugin="cel.addons.celentitytpl" entityname="TinyBox"> <propclass name="pcobject.mesh" /> </addon>
  <addon plugin="cel.addons.celentitytpl" entityname="MicroBox"> <propclass name="pcobject.mesh" /> </addon>
  <addon plugin="cel.addons.celentitytpl" entityname="Sphere"> <propclass name="pcobject.mesh" /> </addon>
  <addon plugin="cel.addons.celentitytpl" entityname="SmallSphere"> <propclass name="pcobject.mesh" /> </addon>

  <addon plugin="cel.addons.dynamicworld.loader">
    <extension plugin="ares.dynworld.loader.factories"/>
    <dynworld name="zone" />
    <factory name="Crate" maxradius="0.5" imposterradius=".3" mass="6">
      <box />
      <attr name="category" value="Objects" />
    </factory>
    <factory name="Box" maxradius="0.5" imposterradius="-1" mass="4">
      <box />
      <attr name="category" value="Varia" />
    </factory>
    <factory name="SmallBox" maxradius="0.5" imposterradius="-1" mass="3">
      <box />
      <attr name="category" value="Varia" />
    </factory>
    <factory name="TinyBox" maxradius="0.5" imposterradius="-1" mass="2">
      <box />
      <attr name="category" value="Varia" />
    </factory>
    <factory name="MicroBox" maxradius="0.5" imposterradius="-1" mass="1">
      <box />
      <attr name="category" value="Varia" />
    </factory>
    <factory name="Sphere" maxradius="0.5" imposterradius="-1" mass="6">
      <sphere />
      <attr name="category" value="Varia" />
    </factory>
    <factory name="SmallSphere" maxradius="0.5" imposterradius="-1" mass="3">
      <sphere />
      <attr name="category" value="Varia" />
    </factory>
  </addon>
</library>
